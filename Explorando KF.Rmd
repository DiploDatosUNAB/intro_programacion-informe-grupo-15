---
title: "Trabajo Práctico 1"
author: "Ankudowicz Santiago y Ferrero Kevin"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# Cargar los paquetes necesarios acá
library(readr)
library(dplyr)
library(ggplot2)
```


## Introducción

Los datos corresponden a reseñas de vinos publicadas en la revista Wine Enthusiast. 

Los datos originales fueron extraídos de [Kaggle](https://www.kaggle.com/zynicide/wine-reviews), que los obtuvo desde Wine Enthusiast  la semana del 15 de junio de 2017. Luego fueron traducidos. En este informe estamos utilizando un archivo csv tal como fue provisto por el docente de la materia. 

```{r}
# Código para cargar o leer los datos
vinos <- read.csv("datos/vinos.csv")
```

```{r}
# Listo los países de los que provienen los vinos reseñados y detallo cuantos provienen de cada país
vinos |> count(pais)
```


## Exploración de los datos

¿Qué variables tiene?
Tiene 10 variables

Puedo usar la función ´ls()´ para listar las variables
```{r}
ls(vinos)
```

También se puede usar la función ´str()´ 
```{r}
str(vinos)
```

¿Cuántas observaciones hay?

Tiene un total de 129.971 observaciones. 
El dato se puede obtener usando ´str()´. También se puede utilizar ´nrow()´. 

```{r}
nrow(vinos)
```

Seleccioná algunas variables resulten interesantes y mostrá sus propiedades.
-   ¿Cuál es su valor medio y desvío estándard?
-   ¿Cuál es su rango (valor máximo y valor mínimo)?
-   ¿Hay alguna anomalía que sugiera que hay datos incorrectos? Valores imposibles (como valores negativos en una variable que sólo puede ser positiva) o poco creíbles.
-   ¿Cuántas observaciones hay por cada grupo? ¿Cuántos valores faltantes? ¿Hay diferencias?

Caracterizo la variable precio
```{r}
vinos|>
  summarise(precio_promedio = mean(precio, na.rm = TRUE), 
            precio_desvest = sd(precio, na.rm = TRUE),
            precio_mín = min(precio, na.rm = TRUE),
            precio_máx = max(precio, na.rm = TRUE))
```
#Averiguo cuantos vinos tienen precio mayor a 1000
```{r}
count(filter(vinos, precio > 1000))
```


Caracterizo la variable puntos
```{r}
vinos|>
  summarise(puntaje_promedio = mean(puntos, na.rm = TRUE), 
            puntaje_desvest = sd(puntos, na.rm = TRUE),
            puntaje_mín = min(puntos, na.rm = TRUE),
            puntaje_máx = max(puntos, na.rm = TRUE))
```



```{r}
cantidad <- vinos |>
  group_by(precio) |>
  summarise(cantidad = n())

```


Gráfico que muestra la relación entre precio y puntos
```{r}
ggplot(data = cantidad, mapping = aes(x = precio, y = cantidad))+
  geom_point()
```

```{r}
summary(vinos)
```
```{r}
vinos_nas <- vinos %>%
  summarise(pais_nas = sum(is.na(pais)), nombre_nas = sum(is.na(nombre)), puntos_nas = sum(is.na(puntos)), precio_nas = sum(is.na(precio)), provincia_nas = sum(is.na(provincia)), region_1_nas = sum(is.na(region_1)), region_2_nas = sum(is.na(region_2)), variedad_nas = sum(is.na(variedad)), vina_nas = sum(is.na(vina)), titulo_resena_nas = sum(is.na(titulo_resena)))
```

```{r}
vinos_variedad_nas <- vinos %>%
  group_by(variedad) %>% 
  summarise(pais_nas = sum(is.na(pais)), nombre_nas = sum(is.na(nombre)), puntos_nas = sum(is.na(puntos)), precio_nas = sum(is.na(precio)), provincia_nas = sum(is.na(provincia)), region_1_nas = sum(is.na(region_1)), region_2_nas = sum(is.na(region_2)), variedad_nas = sum(is.na(variedad)), vina_nas = sum(is.na(vina)), titulo_resena_nas = sum(is.na(titulo_resena)))
```

```{r}
vinos_variedad_nas
```

```{r}
vinos_variedad_nas <- vinos %>%
  group_by(variedad) %>% 
  summarise(cantidad_reseñas = sum(!is.na(puntos)), pais_nas = sum(is.na(pais)), nombre_nas = sum(is.na(nombre)), puntos_nas = sum(is.na(puntos)), precio_nas = sum(is.na(precio)), provincia_nas = sum(is.na(provincia)), region_1_nas = sum(is.na(region_1)), region_2_nas = sum(is.na(region_2)), variedad_nas = sum(is.na(variedad)), vina_nas = sum(is.na(vina)), titulo_resena_nas = sum(is.na(titulo_resena)))
```

```{r}
vinos_variedad_nas
```

```{r}
vinos_pais_nas <- vinos %>%
  group_by(pais) %>% 
  summarise(cantidad_reseñas = sum(!is.na(puntos)), pais_nas = sum(is.na(pais)), nombre_nas = sum(is.na(nombre)), puntos_nas = sum(is.na(puntos)), precio_nas = sum(is.na(precio)), provincia_nas = sum(is.na(provincia)), region_1_nas = sum(is.na(region_1)), region_2_nas = sum(is.na(region_2)), variedad_nas = sum(is.na(variedad)), vina_nas = sum(is.na(vina)), titulo_resena_nas = sum(is.na(titulo_resena)))
```

```{r}
vinos_pais_nas
```

```{r}
vinos_pais_nas <- vinos_pais_nas |>
  mutate(proporción_nombre_nas = nombre_nas/cantidad_reseñas)  
```

```{r}
select(vinos_pais_nas, pais, proporción_nombre_nas)
```


```{r}
vinos_pais <- vinos |>
  group_by(pais) |>
  summarise(precio_promedio = mean(precio, na.rm = TRUE))
```

```{r}
#Filter(vinos_pais_nas, pais == Brazil)
```


```{r}
distinct(vinos, pais)
```


## Hipótesis

